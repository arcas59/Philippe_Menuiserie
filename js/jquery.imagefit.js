!function(t){t.fn.imagefit=function(a){var s=t.extend({},t.fn.imagefit.defaults,a),o=t("html");o.data("main",this),o.data("mode",s.mode),o.data("hor",s.halign),o.data("ver",s.valign),o.data("force",s.force);var h=o.data("main").width(),d=o.data("main").height(),e=0,i=0,r=0;o.data("main").css("overflow","hidden"),o.data("main").css("position","relative"),o.data("main").find("img").each(function(){var a=t(this);a.css("position","absolute");var s=t(this).width(),c=t(this).height(),n=0,f=0,p=[];++r,t("<img/>").attr("src",a.attr("src")).load(function(){p.w=this.width,p.h=this.height,p.w/p.h,"outside"==o.data("mode")?(h/d>s/c?(!1===o.data("force")&&(h>p.w||d>p.h)?(e=p.w,i=p.h,n=Math.round((d-i)/2),f="left"==o.data("hor")?0:"right"==o.data("hor")?f=Math.round((h-e)/2*2):Math.round((h-e)/2)):(e=h,i=Math.round(e*c/s),n=-Math.abs(Math.round((i-d)/2))),"top"==o.data("ver")?(a.css("top","0"),a.css("left",f+"px")):"bottom"==o.data("ver")?(a.css("top",2*n+"px"),a.css("left",f+"px")):(a.css("top",n+"px"),a.css("left",f+"px"))):(!1===o.data("force")&&(h>p.w||d>p.h)?(e=p.w,i=p.h,n=Math.round((d-i)/2),f=Math.round((h-e)/2)):(i=d,e=Math.round(i*s/c),f=-Math.abs(Math.round((e-h)/2))),"left"==o.data("hor")?(a.css("top",n+"px"),a.css("left","0")):"right"==o.data("hor")?(a.css("left",2*f+"px"),a.css("top",n+"px")):(a.css("left",f+"px"),a.css("top",n+"px"))),a.width(e),a.height(i),a.css("width",e),a.css("height",i)):"inside"==o.data("mode")&&(h/d>s/c?(!1===o.data("force")&&h>p.w&&d>p.h?(e=p.w,i=p.h,n=Math.round((d-i)/2),f=Math.round((h-e)/2)):(i=d,e=Math.round(i*s/c),f=Math.round((h-e)/2)),a.css("left",f+"px"),a.css("top",n+"px"),"left"==o.data("hor")&&a.css("left","0"),"top"==o.data("ver")&&a.css("top","0"),"right"==o.data("hor")&&a.css("left",2*f+"px"),"bottom"==o.data("ver")&&a.css("top",2*n+"px")):(!1===o.data("force")&&h>p.w&&d>p.h?(e=p.w,i=p.h,n=Math.round((d-i)/2),f=Math.round((h-e)/2)):(e=h,i=Math.round(e*c/s),n=Math.round((d-i)/2)),a.css("left",f+"px"),a.css("top",n+"px"),"left"==o.data("hor")&&a.css("left","0"),"top"==o.data("ver")&&a.css("top","0"),"right"==o.data("hor")&&a.css("left",2*f+"px"),"bottom"==o.data("ver")&&a.css("top",2*n+"px")),a.width(e),a.height(i),a.css("width",e),a.css("height",i))})}),console.log("imageFit found "+r+" images.")},t.fn.imagefit.defaults={mode:"outside",halign:"center",valign:"middle",force:!0}}(jQuery);